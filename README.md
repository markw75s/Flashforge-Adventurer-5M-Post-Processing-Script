# Flashforge-Adventurer-5M-Post-Processing-Script
Post-processing script for OrcaSlicer to improve metadata visibility on the Flashforge Adventurer 5M screen, with optional spaghetti detector integration.

## How does it work?
This script modifies the structure of a .gcode file generated by OrcaSlicer to improve compatibility with the Flashforge Adventurer 5M printer. It performs the following steps:
1. Metadata Reordering: Moves the configuration block, the header block, and key summary fields (e.g. filament usage, print time) directly after the thumbnail block. This ensures that the printerâ€™s screen displays all relevant metadata correctly.
2. Spaghetti Detector Integration (optional): Adds the subroutine calls into the .gcode, triggered by _"; filament start gcode"_ and _"; filament end gcode"_ (default in OrcaSlicer). This behavior can be toggled via a simple flag within the script.

## Difference Preview
| Without Post-Processing | With Post-Processing |
| ------------- | ------------- |
| ![Without_Post-Processing](https://github.com/user-attachments/assets/c957a398-f16b-4070-b6fe-4047eadd61c3)  | ![With_Post-Processing](https://github.com/user-attachments/assets/f4999600-c6f8-4120-b97c-f822af9b3dc8)  |

## How to install/use
1. Download the python-Script (AD5MPP.py) and put it somewhere you remember.
2. Ensure you have python installed (or a portable Version).
3. In OrcaSlicer: Go to the "Others" Tab and scroll down to the Post-Processing Scripts Field.
4. In this Field you have to paste the path to your python.exe and then the path to the script.<br/>(I.e.: `"C:\Python\python.exe" "C:\Scripts\AD5MPP.py";`)
5. Now you can slice your plate.
6. Once the plate is sliced, the script will automatically run before exporting or uploading the .gcode file, applying all modifications as configured.

### Notes
You can disable the spaghetti detector by opening the script and setting<br/>`enable_spaghetti_detector = True`<br/>to<br/>`enable_spaghetti_detector = False`.<br/>
P.S.: I stumbled upon the spaghetti detector by accident when I researched the .gcode files generated by Flashforges Slicers. I never had a spaghetti failure, so i cannot guarantee it will work. 
